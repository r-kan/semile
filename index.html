<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>semile by r-kan</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-light.css">
    <meta name="viewport" content="width=device-width">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>semile</h1>
        <p>profile what you care, monitor how it goes</p>

        <p class="view"><a href="https://github.com/r-kan/semile">View the Project on GitHub <small>r-kan/semile</small></a></p>


        <ul>
          <li><a href="https://github.com/r-kan/semile/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/r-kan/semile/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/r-kan/semile">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>
<a id="semile-" class="anchor" href="#semile-" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>semile :)</h1>

<p><em>Why semile?</em><br>
<em>We semile bcoz it helps overcome the flaw/bottleneck of our programs</em></p>

<hr>

<h1>
<a id="what-is-semile" class="anchor" href="#what-is-semile" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>What is <em>semile</em>?</h1>

<p>A profiling framework that provides the ability to monitor programs, in general of any programming language, by the following two pieces of information:<br>
1. consumed time per execution<br>
2. 'footprint' debug message per execution  </p>

<h1>
<a id="difference-with-other-profiling-tools" class="anchor" href="#difference-with-other-profiling-tools" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Difference with other profiling tools?</h1>

<ul>
<li>
<strong><em>Profile 'semantically'</em></strong>  Each call to the same function plays its individual role within profiling. Normal 'syntactic' profilers are good in other aspects but fail to achieve this.<br>
</li>
<li>
<strong><em>Lightweight</em></strong>  The profiled program gives little run-time overhead. The viewer is compact that targets to provide only necessary information without fancy visual effect. It gives profile result in widespread PNG and XML format.<br>
</li>
<li>
<strong><em>Message-embedded profile</em></strong>  Custom information can be left within profile elements. It then also provides the ability to help reveal internal state/decision inside the program.<br>
</li>
</ul>

<p>P.S. The user-provided semantic specifications (via the profile library) is necessary for semantic profile  </p>

<h1>
<a id="system-requirement" class="anchor" href="#system-requirement" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>System Requirement</h1>

<p>python3 (viewer)<br>
g++ (c/cpp profile library)  </p>

<h1>
<a id="dependent-library" class="anchor" href="#dependent-library" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dependent Library</h1>

<p><a href="http://www.graphviz.org">dot (graphviz)</a>    </p>

<hr>

<h1>
<a id="viewer-demonstration" class="anchor" href="#viewer-demonstration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Viewer Demonstration</h1>

<p><a href="https://raw.githubusercontent.com/r-kan/r-kan.github.io/master/images/semile/sample.png"><img border="0" alt="semile viewer PNG format sample" src="https://raw.githubusercontent.com/r-kan/r-kan.github.io/master/images/semile/sample.png" width="616" height="117"></a><br>
(PNG format)  </p>

<p><a href="https://raw.githubusercontent.com/r-kan/r-kan.github.io/master/images/semile/sample_xml.png"><img border="0" alt="semile viewer PNG format sample" src="https://raw.githubusercontent.com/r-kan/r-kan.github.io/master/images/semile/sample_xml.png" width="252" height="188"></a><br>
(XML format, browse by <a href="http://codebeautify.org/xmlviewer">codebeautify.org/xmlviewer</a>))</p>

<hr>

<h1>
<a id="profile-library" class="anchor" href="#profile-library" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Profile Library</h1>

<p><code>semile</code> does not aim to profile all program execution, it only profile the execution specified via the profile library. Currently, cpp profile library is provided.  </p>

<h1>
<a id="tutorial-profile-a-cpp-program" class="anchor" href="#tutorial-profile-a-cpp-program" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tutorial: profile a cpp program</h1>

<ol>
<li>Choose the statements to be profiled<br>
</li>
<li>Have a <code>SEMILE</code> in same scope of the statements<br>
</li>
</ol>

<p>And that's it!  </p>

<p>In particular, a helpful way diagnosing is use <code>SEMILE_MSG</code> to leave custom footprint message.  </p>

<h1>
<a id="code-example" class="anchor" href="#code-example" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Code example</h1>

<div class="highlight highlight-source-c++"><pre><span class="pl-k">void</span> <span class="pl-en">quicksort</span>(vector&lt;<span class="pl-k">int</span>&gt;&amp; x, <span class="pl-k">int</span> start_pos, <span class="pl-k">int</span> end_pos)
{
  SEMILE; <span class="pl-c">// profile at beginning of the scope</span>
  <span class="pl-c">// SEMILE_N(abc); // or profile with custom name</span>
  ...
}</pre></div>

<p>Here, every <em>quicksort</em> execution will be profiled.<br>
Nested, or recursive <code>SEMILE</code> is also possible.</p>

<div class="highlight highlight-source-c++"><pre><span class="pl-k">void</span> <span class="pl-en">quicksort</span>(vector&lt;<span class="pl-k">int</span>&gt;&amp; x, <span class="pl-k">int</span> start_pos, <span class="pl-k">int</span> end_pos)
{
  SEMILE;
  <span class="pl-c1">SEMILE_MSG</span>(<span class="pl-c1">GetStr</span>(x, start_pos, end_pos));
  ...
  <span class="pl-k">int</span> pivot = start_pos;
  <span class="pl-c1">SEMILE_MSG</span>(<span class="pl-s"><span class="pl-pds">"</span>pivot: <span class="pl-pds">"</span></span> + <span class="pl-c1">GetStr</span>(x[pivot]) + <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\\</span>n<span class="pl-pds">"</span></span>);
  ...
  <span class="pl-c1">Swap</span>(x, i, j);  
  <span class="pl-c1">SEMILE_MSG</span>(<span class="pl-c1">GetStr</span>(x[i]) + <span class="pl-s"><span class="pl-pds">"</span> &lt;=&gt; <span class="pl-pds">"</span></span> + <span class="pl-c1">GetStr</span>(x[j]) + <span class="pl-s"><span class="pl-pds">"</span><span class="pl-cce">\\</span>n<span class="pl-pds">"</span></span>);
}</pre></div>

<p>After <code>SEMILE</code>, we can have <code>SEMILE_MSG</code> at any time to log profile message.<br>
Here, internal flow of <em>quicksort</em> is revealed and combined to resulted profile.  </p>

<p>One possible viewer generated PNG is then as follows:<br>
(run quicksort 3 times with random inputs)<br>
<a href="https://raw.githubusercontent.com/r-kan/r-kan.github.io/master/images/semile/profile_quicksort.png"><img border="0" alt="the viewer generated PNG for quicksort" src="https://raw.githubusercontent.com/r-kan/r-kan.github.io/master/images/semile/profile_quicksort.png" width="616" height="161"></a>  </p>

<hr>

<p>Except c++, <code>semile</code> also profiles c sources via the c interface.</p>

<h1>
<a id="tutorial-exploit-the-c-interface" class="anchor" href="#tutorial-exploit-the-c-interface" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Tutorial: exploit the c interface</h1>

<p>Due to the lack of RAII, <code>semile</code> support in c requires a pair of profile specifications:<br>
1. <code>SEMILE_BEGIN</code>, where profile resource is allocated<br>
2. <code>SEMILE_END</code>, where profile resource is released  </p>

<h1>
<a id="code-example-1" class="anchor" href="#code-example-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Code example</h1>

<div class="highlight highlight-source-c"><pre><span class="pl-k">void</span> <span class="pl-en">quicksort</span>(<span class="pl-k">int</span>* x, <span class="pl-k">int</span> start_pos, <span class="pl-k">int</span> end_pos)
{
  <span class="pl-k">void</span>* inst = SEMILE_BEGIN;
  <span class="pl-c1">SEMILE_MSG_C</span>(inst, <span class="pl-c1">GetStr</span>(x, start_pos, end_pos));
  ...
  <span class="pl-c1">SEMILE_END</span>(inst);
}</pre></div>

<p>It takes much care to handle <code>SEMILE_END</code>. However, be able to control directly the profile instance also gives much flexibility, e.g., conditional profile:</p>

<div class="highlight highlight-source-c"><pre><span class="pl-k">void</span>* inst = <span class="pl-c1">NULL</span>;
<span class="pl-k">if</span> (is_cared_run) {
  inst = SEMILE_BEGIN;
}
...
<span class="pl-en">SEMILE_END</span>(inst);</pre></div>

<hr>

<p>Finally, there are two ways to disable semile:<br>
1. compile time: -DSEMILE_DISABLE in compiler option<br>
2. run time: setenv SEMILE_ENABLE 0  </p>

<hr>

<h1>
<a id="contact" class="anchor" href="#contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Contact</h1>

<p>Please contact <a href="http://r-kan.github.io"><em>Rodney Kan</em></a> by <a href="mailto:its_right@msn.com">its_right@msn.com</a> for any question/request/bug without hesitation. </p>


      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/r-kan">r-kan</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
